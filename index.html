<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>PhoneStore RD | Pro Store</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #fdfdfd; scroll-behavior: smooth; }
        .btn-gradient { background: linear-gradient(90deg, #0071e3, #3b82f6); color: white; }
        .footer-black { background: #0b0f1a; color: white; }
        .product-card { background: white; border-radius: 35px; border: 1px solid #f0f0f0; transition: 0.4s; overflow: hidden; }
        .product-card:hover { transform: translateY(-10px); box-shadow: 0 30px 60px rgba(0,0,0,0.08); }
        .nav-link { cursor: pointer; font-weight: 800; transition: 0.3s; position: relative; }
        .nav-link.active { color: #0071e3; }
        .nav-link.active::after { content: ''; position: absolute; bottom: -5px; left: 0; width: 100%; height: 3px; background: #0071e3; border-radius: 10px; }
        .trust-card { background: white; padding: 30px; border-radius: 30px; text-align: center; border: 1px solid #f0f0f0; }
    </style>
</head>
<body>

    <header class="bg-white/90 backdrop-blur-md sticky top-0 z-[100] px-6 py-5 border-b border-gray-100">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div id="ps-logo" class="flex items-center gap-3 cursor-pointer">
                <div class="w-12 h-12 btn-gradient rounded-2xl flex items-center justify-center text-white font-black text-xl shadow-lg">PS</div>
                <h1 class="text-xl font-900 tracking-tighter text-gray-900">PhoneStore RD</h1>
            </div>
            <nav class="hidden md:flex gap-10">
                <span onclick="switchTab('phones')" id="tab-phones" class="nav-link active uppercase text-xs tracking-widest">iPhones</span>
                <span onclick="switchTab('accs')" id="tab-accs" class="nav-link uppercase text-xs tracking-widest text-gray-400">Accesorios</span>
            </nav>
            <div class="flex gap-4">
                <a href="https://wa.me/8098182320" class="text-green-500 text-2xl"><i class="fa-brands fa-whatsapp"></i></a>
                <i class="fa-brands fa-instagram text-pink-500 text-2xl"></i>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 py-12">
        <div class="mb-16 flex flex-col md:flex-row justify-between items-center gap-6">
            <h2 id="section-title" class="text-5xl font-900 tracking-tighter text-gray-900">Catálogo iPhones</h2>
            <div class="relative w-full md:w-96">
                <input type="text" id="main-search" placeholder="Buscar..." class="w-full bg-gray-100 border-none rounded-2xl py-4 px-6 pl-12 focus:ring-2 focus:ring-blue-500 outline-none font-bold">
                <i class="fa-solid fa-magnifying-glass absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
            </div>
        </div>

        <div id="grid-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8"></div>

        <hr class="my-32 border-gray-100">

        <section class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-32">
            <div class="trust-card shadow-sm">
                <i class="fa-solid fa-microchip text-4xl text-blue-600 mb-4"></i>
                <h4 class="font-900 text-lg mb-2 text-gray-900">Piezas Originales</h4>
                <p class="text-gray-400 text-sm font-bold">Certificamos componentes de fábrica sin reparaciones ocultas.</p>
            </div>
            <div class="trust-card shadow-sm">
                <i class="fa-solid fa-gem text-4xl text-blue-600 mb-4"></i>
                <h4 class="font-900 text-lg mb-2 text-gray-900">Equipos Grado A+</h4>
                <p class="text-gray-400 text-sm font-bold">Selección impecable con salud de batería óptima garantizada.</p>
            </div>
            <div class="trust-card shadow-sm">
                <i class="fa-solid fa-rotate text-4xl text-blue-600 mb-4"></i>
                <h4 class="font-900 text-lg mb-2 text-gray-900">Valor de Reventa</h4>
                <p class="text-gray-400 text-sm font-bold">Tu inversión mantiene el mejor valor en el mercado de usados.</p>
            </div>
        </section>

        <section id="ubicacion" class="mb-32">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-900 tracking-tighter text-gray-900">Nuestra Ubicación</h2>
                <p id="display-address" class="text-gray-500 font-bold italic underline"></p>
            </div>
            <div class="rounded-[40px] overflow-hidden border-[10px] border-white shadow-2xl h-[450px]">
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3785.123456789!2d-70.0167!3d18.4333!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zMTjCsDI2JzAwLjAiTiA3MMKwMDEnMDAuMCJX!5e0!3m2!1ses!2sdo!4v1234567890" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
            </div>
        </section>
    </main>

    <footer class="footer-black pt-20 pb-10 px-6">
        <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-16 mb-16">
            <div>
                <h3 class="text-3xl font-900 mb-6 italic">PhoneStore RD</h3>
                <p id="footer-address" class="text-gray-400 font-bold italic"></p>
                <p class="text-blue-500 font-black mt-2">WhatsApp: 809-818-2320</p>
            </div>
            <div class="text-center md:text-right">
                <h4 class="text-blue-500 font-black mb-4 uppercase text-sm">Horario</h4>
                <p class="text-gray-400 font-bold">Lun - Sab: 9AM - 7PM</p>
            </div>
        </div>
        <p class="text-center text-[10px] text-gray-600 uppercase tracking-widest">© 2026 PhoneStore RD</p>
    </footer>

    <div id="receipt-modal" class="fixed inset-0 z-[200] hidden items-center justify-center p-4 bg-black/80 backdrop-blur-md">
        <div class="bg-white rounded-[40px] w-full max-w-md p-10 text-center">
            <h2 class="text-3xl font-900 mb-6 tracking-tighter">Tu Recibo Digital</h2>
            <div id="rec-info" class="bg-blue-50 p-6 rounded-3xl mb-6 text-left border border-blue-100 text-gray-900 font-bold"></div>
            <div class="space-y-4">
                <input type="text" id="client-name" placeholder="Nombre" class="w-full p-4 bg-gray-100 rounded-xl outline-none font-bold">
                <input type="email" id="client-email" placeholder="Correo" class="w-full p-4 bg-gray-100 rounded-xl outline-none font-bold">
                <button onclick="enviarPedidoCompleto()" class="w-full bg-[#25d366] text-white py-5 rounded-2xl font-black uppercase">CONFIRMAR PEDIDO</button>
                <button onclick="document.getElementById('receipt-modal').classList.add('hidden')" class="text-gray-300 font-bold text-xs mt-2">Cerrar</button>
            </div>
        </div>
    </div>

    <div id="admin-panel" class="fixed inset-0 z-[200] hidden bg-black/60 backdrop-blur-xl flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-5xl p-10 shadow-2xl rounded-[40px] overflow-y-auto max-h-[95vh]">
            <h2 class="text-3xl font-900 text-blue-600 mb-8">Gestión de Inventario</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
                <div class="space-y-6 border-r border-gray-100 pr-0 lg:pr-10">
                    <h3 class="font-black uppercase text-xs text-gray-400">Nuevo Producto</h3>
                    <div class="bg-blue-50 p-6 rounded-3xl">
                        <a href="https://postimages.org/" target="_blank" class="block w-full bg-blue-600 text-white text-center py-4 rounded-2xl font-black text-sm mb-4">
                            <i class="fa-solid fa-cloud-arrow-up mr-2"></i> SUBIR FOTO A POSTIMAGES
                        </a>
                        <input type="text" id="a-url" oninput="previewUrl(this.value)" placeholder="Pega el Enlace Directo aquí" class="w-full p-4 rounded-xl font-bold border-none outline-none mb-4 shadow-sm">
                        <div class="w-full h-32 bg-white rounded-2xl overflow-hidden flex items-center justify-center mb-4">
                            <img id="admin-preview" class="hidden w-full h-full object-contain">
                            <span id="admin-placeholder" class="text-gray-300 font-bold text-[10px]">VISTA PREVIA</span>
                        </div>
                        <input type="text" id="a-name" placeholder="Nombre (Ej: iPhone 14 Pro)" class="w-full p-4 bg-white rounded-xl font-bold border-none outline-none mb-4 shadow-sm">
                        <input type="number" id="a-price" placeholder="Precio RD$" class="w-full p-4 bg-white rounded-xl font-bold border-none outline-none mb-4 shadow-sm">
                        <textarea id="a-desc" placeholder="Descripción corta..." class="w-full p-4 bg-white rounded-xl font-bold border-none outline-none h-20 shadow-sm"></textarea>
                        <button id="btn-save" class="btn-gradient w-full py-5 rounded-2xl font-black shadow-lg">PUBLICAR AHORA</button>
                    </div>
                </div>

                <div class="space-y-6">
                    <h3 class="font-black uppercase text-xs text-gray-400">Productos en Web (Para Borrar)</h3>
                    <div id="admin-list" class="space-y-3 max-h-[500px] overflow-y-auto pr-2">
                        </div>
                    <button onclick="document.getElementById('admin-panel').classList.add('hidden')" class="w-full py-4 text-gray-400 font-black text-xs uppercase border-2 border-gray-100 rounded-2xl">Cerrar Panel</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCdn4m4n3Aezuttg8E31DmipXLz0dBueU",
            projectId: "tiendacelularesrd-f0795",
            appId: "1:264926688681:web:4d2c5aa50ea2bce0e100b8"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let activeTab = 'phones';
        let adminClicks = 0;

        document.getElementById('ps-logo').onclick = () => {
            adminClicks++;
            if(adminClicks === 5) {
                if(prompt("PASSWORD:") === "Avd121094") document.getElementById('admin-panel').classList.remove('hidden');
                adminClicks = 0;
            }
        };

        const addr = localStorage.getItem('store-address') || "Haina, San Cristóbal";
        document.getElementById('display-address').innerText = addr;
        document.getElementById('footer-address').innerText = addr;

        window.previewUrl = (url) => {
            const img = document.getElementById('admin-preview');
            const place = document.getElementById('admin-placeholder');
            if(url.includes('http')) {
                img.src = url;
                img.classList.remove('hidden');
                place.classList.add('hidden');
            }
        };

        // GUARDAR PRODUCTO
        document.getElementById('btn-save').onclick = async () => {
            const name = document.getElementById('a-name').value;
            const price = document.getElementById('a-price').value;
            const desc = document.getElementById('a-desc').value;
            const url = document.getElementById('a-url').value;

            if(!name || !price || !url) return alert("Completa los datos");

            try {
                await addDoc(collection(db, "productos"), {
                    n: name, p: price, d: desc, 
                    cat: name.toLowerCase().includes('iphone') ? 'phones' : 'accs',
                    imgs: [url], creado: Date.now()
                });
                alert("¡Publicado!");
                document.getElementById('a-name').value = "";
                document.getElementById('a-price').value = "";
                document.getElementById('a-url').value = "";
            } catch (e) { alert("Error al subir"); }
        };

        // FUNCIÓN PARA BORRAR
        window.borrarProducto = async (id) => {
            if(confirm("¿Estás seguro de borrar este producto de la web?")) {
                await deleteDoc(doc(db, "productos", id));
            }
        };

        window.switchTab = (t) => {
            activeTab = t;
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.getElementById('tab-' + t).classList.add('active');
            loadAll();
        };

        window.openModal = (n, p) => {
            document.getElementById('rec-info').innerHTML = `${n}<br><span class="text-blue-600 text-2xl">RD$ ${Number(p).toLocaleString()}</span>`;
            document.getElementById('receipt-modal').classList.replace('hidden', 'flex');
        };

        function loadAll() {
            const grid = document.getElementById('grid-container');
            const adminList = document.getElementById('admin-list');
            
            onSnapshot(query(collection(db, "productos"), orderBy("creado", "desc")), (snap) => {
                grid.innerHTML = "";
                adminList.innerHTML = "";
                
                snap.forEach(docSnap => {
                    const d = docSnap.data();
                    const id = docSnap.id;

                    // Llenar Lista Admin (Para borrar)
                    const itemAdmin = document.createElement('div');
                    itemAdmin.className = "flex items-center justify-between bg-gray-50 p-4 rounded-2xl border border-gray-100";
                    itemAdmin.innerHTML = `
                        <div class="flex items-center gap-3">
                            <img src="${d.imgs[0]}" class="w-10 h-10 object-cover rounded-lg">
                            <div>
                                <p class="text-[10px] font-black text-gray-800 uppercase">${d.n}</p>
                                <p class="text-[9px] text-blue-500 font-bold">RD$ ${Number(d.p).toLocaleString()}</p>
                            </div>
                        </div>
                        <button onclick="borrarProducto('${id}')" class="text-red-500 hover:bg-red-50 p-2 rounded-xl transition">
                            <i class="fa-solid fa-trash-can"></i>
                        </button>`;
                    adminList.appendChild(itemAdmin);

                    // Llenar Catálogo Web
                    if(d.cat === activeTab) {
                        const card = document.createElement('div');
                        card.className = "product-card";
                        card.innerHTML = `
                            <img src="${d.imgs[0]}" class="w-full h-72 object-cover">
                            <div class="p-8">
                                <h3 class="font-900 text-xl text-gray-900">${d.n}</h3>
                                <p class="text-[10px] text-gray-400 font-bold uppercase mb-4">${d.d}</p>
                                <div class="flex justify-between items-center">
                                    <span class="text-xl font-900 text-gray-900">RD$ ${Number(d.p).toLocaleString()}</span>
                                    <button onclick="openModal('${d.n}', ${d.p})" class="btn-gradient px-5 py-2 rounded-xl text-[10px] font-black uppercase">Apartar</button>
                                </div>
                            </div>`;
                        grid.appendChild(card);
                    }
                });
            });
        }
        loadAll();
    </script>
</body>
</html>
